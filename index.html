<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Operator Blueprints – Revenue Forecast</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="topbar-left">
      <div class="logo-dot"></div>
      <div class="topbar-title-group">
        <h1>Operator Blueprints</h1>
        <p class="topbar-subtitle">Revenue Forecast Tool</p>
      </div>
    </div>
    <div class="topbar-right">
      <span class="badge">Style A · Minimalist Operator Dashboard</span>
    </div>
  </header>

  <main class="layout">
    <!-- INPUTS PANEL -->
    <section class="panel panel-inputs">
      <h2>Assumptions</h2>
      <p class="panel-subtitle">Set the core drivers once, then run scenarios with confidence.</p>

      <form id="forecast-form" class="form-grid" onsubmit="event.preventDefault(); runForecast();">
        <!-- Starting revenue -->
        <div class="form-field">
          <label for="startRevenue">Starting Recurring Revenue</label>
          <div class="input-prefix">
            <span class="prefix">$</span>
            <input
              type="number"
              id="startRevenue"
              min="0"
              step="1"
              value="25000"
              required
            />
          </div>
          <p class="field-hint">Current recurring revenue at the start of the model.</p>
        </div>

        <!-- Growth engine mode -->
        <div class="form-field">
          <label>Growth Engine</label>
          <div class="mode-row">
            <label class="mode-option">
              <input type="radio" name="growthMode" value="percent" checked />
              <span>Percentage</span>
            </label>
            <label class="mode-option">
              <input type="radio" name="growthMode" value="traffic" />
              <span>Traffic · Conversion · AOV</span>
            </label>
          </div>
          <p class="field-hint">
            Use a flat % per period or drive the curve from traffic, conversion, and AOV.
          </p>
        </div>

        <!-- Base growth -->
        <div class="form-field">
          <label for="growthRate">Base Growth Rate per Period</label>
          <div class="input-suffix">
            <input
              type="number"
              id="growthRate"
              step="0.1"
              value="8"
              required
            />
            <span class="suffix">%</span>
          </div>
          <p class="field-hint">
            Used when Growth Engine is set to Percentage. In Traffic mode, this is ignored.
          </p>
        </div>

        <!-- Horizon / N -->
        <div class="form-field">
          <label for="periodCount">Number of Periods</label>
          <div class="range-row">
            <input
              type="range"
              id="periodCount"
              min="3"
              max="60"
              value="12"
              oninput="syncPeriodsLabel(this.value)"
            />
            <span id="periodsLabel">12 periods</span>
          </div>
          <p class="field-hint">How many steps you want to see along the curve.</p>
        </div>

        <!-- Time unit -->
        <div class="form-field">
          <label for="timeUnit">Time Unit</label>
          <select id="timeUnit" class="select-input" onchange="syncPeriodsLabel(document.getElementById('periodCount').value)">
            <option value="month" selected>Months</option>
            <option value="week">Weeks</option>
            <option value="year">Years</option>
          </select>
          <p class="field-hint">Control whether the forecast runs in months, weeks, or years.</p>
        </div>

        <!-- Scenario multipliers -->
        <div class="form-field">
          <label for="conservativeFactor">Conservative Growth Multiplier</label>
          <input
            type="number"
            id="conservativeFactor"
            step="0.1"
            value="0.5"
          />
          <p class="field-hint">
            Percentage mode: multiplier on growth %. Traffic mode: multiplier on traffic growth.
          </p>
        </div>

        <div class="form-field">
          <label for="aggressiveFactor">Aggressive Growth Multiplier</label>
          <input
            type="number"
            id="aggressiveFactor"
            step="0.1"
            value="1.5"
          />
          <p class="field-hint">
            Percentage mode: multiplier on growth %. Traffic mode: multiplier on traffic growth.
          </p>
        </div>

        <!-- Notion-style assumptions -->
        <div class="form-divider"></div>
        <h3 class="section-subheading">Traffic · Conversion · AOV (Notion Inputs)</h3>

        <div class="form-field">
          <label for="traffic">Current Monthly Traffic</label>
          <input
            type="number"
            id="traffic"
            min="0"
            step="100"
            placeholder="5000"
          />
          <p class="field-hint">Number of visitors per period (e.g., 5,000).</p>
        </div>

        <div class="form-field">
          <label for="trafficGrowth">Expected Traffic Growth % per Period</label>
          <input
            type="number"
            id="trafficGrowth"
            step="0.1"
            placeholder="10"
          />
          <p class="field-hint">Assumption for traffic growth (e.g., 10 for 10%).</p>
        </div>

        <div class="form-field">
          <label for="baselineCR">Baseline Conversion Rate %</label>
          <input
            type="number"
            id="baselineCR"
            step="0.1"
            placeholder="2"
          />
          <p class="field-hint">Current conversion rate (e.g., 2%).</p>
        </div>

        <div class="form-field">
          <label for="targetCR">Target Conversion Rate %</label>
          <input
            type="number"
            id="targetCR"
            step="0.1"
            placeholder="3"
          />
          <p class="field-hint">Stretch goal after optimization.</p>
        </div>

        <div class="form-field">
          <label for="aov">Average Order Value (AOV)</label>
          <div class="input-prefix">
            <span class="prefix">$</span>
            <input
              type="number"
              id="aov"
              min="0"
              step="1"
              placeholder="85"
            />
          </div>
          <p class="field-hint">Average order size (e.g., $85).</p>
        </div>

        <div class="form-field">
          <label>Implied Current Monthly Revenue</label>
          <div class="implied-row">
            <span id="impliedRevenue">–</span>
            <button type="button" class="btn-secondary btn-xs" onclick="applyImpliedToStart()">
              Apply to Starting Revenue
            </button>
          </div>
          <p class="field-hint">
            Calculated from Traffic × Conversion × AOV using baseline conversion.
          </p>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-secondary" onclick="resetInputs()">
            Reset Inputs
          </button>
          <button type="submit" class="btn-primary">
            Run Forecast
          </button>
        </div>
      </form>

      <div class="assumption-note">
        <h3>How the model behaves</h3>
        <p>
          Percentage mode compounds revenue each period using your base growth rate.
          Traffic mode compounds traffic, moves conversion from baseline to target, and
          multiplies by AOV. Conservative and aggressive scenarios adjust growth multipliers
          so one assumption set gives you a clean band of outcomes.
        </p>
      </div>
    </section>

    <!-- OUTPUT PANEL -->
    <section class="panel panel-output">
      <h2>Forecast Output</h2>
      <p class="panel-subtitle">Three scenarios. One view. Operator-ready.</p>

      <!-- KPI STRIP -->
      <div class="kpi-strip">
        <div class="kpi-card">
          <p class="kpi-label">Ending Recurring Revenue · Base</p>
          <p class="kpi-value" id="baseMRR">–</p>
          <p class="kpi-tag">Growth @ <span id="baseRateLabel">–</span></p>
        </div>
        <div class="kpi-card">
          <p class="kpi-label">Ending Recurring Revenue · Conservative</p>
          <p class="kpi-value" id="conservativeMRR">–</p>
          <p class="kpi-tag">@ <span id="conservativeRateLabel">–</span></p>
        </div>
        <div class="kpi-card">
          <p class="kpi-label">Ending Recurring Revenue · Aggressive</p>
          <p class="kpi-value" id="aggressiveMRR">–</p>
          <p class="kpi-tag">@ <span id="aggressiveRateLabel">–</span></p>
        </div>
        <div class="kpi-card">
          <p class="kpi-label">Total Revenue · Base</p>
          <p class="kpi-value" id="totalBaseRevenue">–</p>
          <p class="kpi-tag"><span id="periodsSummary">0 periods</span> cumulative</p>
        </div>
      </div>

      <!-- OUTPUT ACTIONS -->
      <div class="output-actions">
        <button type="button" class="btn-secondary" onclick="downloadCSV()">
          Download CSV
        </button>
      </div>

      <!-- CHART -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Revenue Curve</h3>
          <p>Base, conservative, and aggressive scenarios across your time horizon.</p>
        </div>
        <div class="chart-wrapper">
          <canvas id="forecastChart"></canvas>
        </div>
      </div>

      <!-- TEXTUAL SUMMARY -->
      <div class="summary-card">
        <h3>Scenario Summary</h3>
        <ul id="summaryList" class="summary-list">
          <li>Run a forecast to populate the summary.</li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="footer">
    <span>Operator Blueprints · Revenue Forecast</span>
    <span>Speed is the moat · Precision is the standard</span>
  </footer>

  <script src="script.js"></script>
</body>
</html>
